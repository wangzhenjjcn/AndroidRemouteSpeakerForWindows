# Web 播放器快速入门

## 🚀 5 分钟快速开始

### 步骤 1: 构建项目 (首次使用)

在项目根目录打开 PowerShell:

```powershell
# 构建 Windows 端
pwsh -ExecutionPolicy Bypass -File .\scripts\build.ps1
```

或者使用 Visual Studio:
1. 打开 `windows/AudioBridge.Windows.sln`
2. 选择 Release 配置
3. 点击"生成 → 生成解决方案"

### 步骤 2: 启动 Windows 端

1. 运行 `windows/App/bin/Release/net8.0-windows/AudioBridge.Windows.exe`
2. 在主界面:
   - 选择音频源设备 (通常选择默认设备)
   - ✅ 勾选 **"启用 Web 服务"**
   - 端口保持默认 (29763) 或自定义
   - 点击 **"开始推流"** 按钮

✅ 成功标志: 状态栏显示 "Web 服务已启动，访问 http://localhost:29763"

### 步骤 3: 打开播放器

**方式 A - 推荐**: 点击主界面的 **"打开网页"** 按钮

**方式 B - 手动**: 
- 在浏览器中访问 `http://localhost:29763/player.html`
- 或使用实际 IP: `http://192.168.x.x:29763/player.html`

### 步骤 4: 连接并播放

1. 在播放器页面点击 **"连接"** 按钮
2. 等待连接状态变为 **"已连接"** (绿色指示灯)
3. 播放音乐或视频,浏览器会自动播放音频! 🎵

### 步骤 5: 调节音量

拖动音量滑块 (0-100%) 即可调节播放音量

---

## 📱 在手机上使用

### Android / iOS

1. 确保手机与 Windows 在同一 Wi-Fi 网络
2. 在 Windows 端查看本机 IP 地址:
   - 打开命令提示符
   - 输入 `ipconfig`
   - 找到 "IPv4 地址" (如 192.168.1.100)
3. 在手机浏览器访问:
   ```
   http://192.168.1.100:29763/player.html
   ```
4. 点击"连接"并开始播放

---

## ⚙️ 配置选项

### 修改端口

1. 在 Windows 端主界面
2. 将 "端口" 从 29763 改为其他值 (如 8080)
3. 重新启动推流
4. 访问新地址: `http://localhost:8080/player.html`

### 防火墙设置

如果无法连接,可能需要允许防火墙:

1. 打开 "Windows Defender 防火墙"
2. 点击 "允许应用通过防火墙"
3. 添加 `AudioBridge.Windows.exe`
4. 勾选 "专用" 和 "公用" 网络

---

## 🔧 故障排查

### ❌ 无法连接

**检查清单**:
- [ ] Windows 端已启用 Web 服务
- [ ] Windows 端正在推流
- [ ] 端口号输入正确
- [ ] 防火墙未阻止
- [ ] 同一网络 (局域网)

**解决方案**:
```powershell
# 测试端口是否开放
Test-NetConnection -ComputerName localhost -Port 29763
```

### 🔇 没有声音

**检查清单**:
- [ ] Windows 端有音频输出 (播放音乐)
- [ ] 浏览器音量未静音
- [ ] 网页播放器音量 > 0%
- [ ] 浏览器允许自动播放

**解决方案**:
1. 打开浏览器开发者工具 (F12)
2. 查看 Console 标签是否有错误
3. 尝试刷新页面并重新连接

### ⏱️ 延迟过高

**现象**: 音频明显延迟 (> 1 秒)

**解决方案**:
1. 使用有线网络而非 Wi-Fi
2. 关闭其他占用带宽的应用
3. 减少浏览器标签页数量
4. 清空浏览器缓存

### 🔊 音频断断续续

**现象**: 播放卡顿、爆音

**解决方案**:
1. 检查网络连接稳定性
2. 关闭下载等占用带宽的任务
3. 减少同时连接的客户端数量

---

## 📊 查看统计信息

播放器底部显示实时统计:

| 指标 | 说明 | 正常值 |
|------|------|--------|
| **已接收** | 收到的音频包数量 | 持续增长 |
| **数据量** | 累计数据量 (KB) | 持续增长 |
| **延迟** | 平均包间隔 (ms) | 20-50 ms |
| **缓冲** | 队列中的缓冲数 | 0-5 |

**异常情况**:
- 延迟 > 100ms: 网络不稳定
- 缓冲 > 10: 播放速度慢于接收速度
- 缓冲 = 0 且频繁: 网络不稳定或带宽不足

---

## 🎯 使用技巧

### 1. 多设备同时收听

可以同时在多个设备上打开播放器:
- 笔记本浏览器
- 台式机浏览器
- 手机浏览器
- 平板浏览器

所有设备会同步播放相同的音频! 🎉

### 2. 在平板上使用

非常适合在平板上使用:
- 响应式 UI 适配屏幕
- 触摸操作流畅
- 可放在桌面当音箱

### 3. 在电视浏览器上使用

如果你的智能电视有浏览器:
- 访问播放器地址
- 连接后作为无线音箱使用

### 4. 远程办公场景

将办公电脑的音频流式传输到笔记本:
- 主机: Windows 端推流
- 笔记本: 浏览器播放
- 随处移动,音频跟随

---

## 🔒 安全提示

### ⚠️ 仅在受信任网络使用

Web 播放器使用未加密的 HTTP 连接:
- ✅ 家庭网络: 安全
- ✅ 办公室局域网: 安全
- ❌ 公共 Wi-Fi: 不推荐
- ❌ 互联网: 不推荐

### 🛡️ 不要暴露到公网

不要在路由器上配置端口转发:
- 可能导致未授权访问
- 音频内容可能被窃听

---

## 📚 更多资源

- **详细文档**: `doc/web-player.md`
- **测试指南**: `doc/web-testing.md`
- **开发总结**: `doc/web-development-summary.md`
- **API 文档**: `doc/API.md`

---

## 💡 常见问题

### Q: 可以在 Mac 上使用吗?
A: 可以! 虽然服务端需要 Windows,但播放器可以在 Mac 的浏览器中使用。

### Q: 支持哪些浏览器?
A: Chrome, Edge, Firefox, Safari 14.1+ 等所有支持 Web Audio API 的浏览器。

### Q: 是否支持 iPhone?
A: 支持! 使用 Safari 浏览器访问播放器即可。

### Q: 可以同时使用 Android 客户端和 Web 播放器吗?
A: 可以! 两者可以同时工作,互不干扰。

### Q: 延迟有多低?
A: 局域网环境下通常为 100-200ms,有线连接可达 50-100ms。

### Q: 占用多少带宽?
A: PCM16 格式约 1.5 Mbps (48kHz 立体声)。未来版本将支持 Opus 编码,降至 96-160 kbps。

### Q: 可以录制吗?
A: 当前版本不支持。未来版本将添加客户端录制功能。

### Q: 需要安装什么吗?
A: Windows 端需要安装,浏览器端无需安装任何东西。

### Q: 可以商用吗?
A: 本项目采用 MIT 许可证,可以免费商用。

---

## 🎉 享受你的音频流吧!

现在你已经完成了所有设置,尽情享受无线音频流的便利吧! 

如有问题或建议,请提交 Issue 到 GitHub 仓库。

Happy Streaming! 🎵🎶🎼

